{"ast":null,"code":"import _classCallCheck from \"/Users/selim/repo/eryaz/angular/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/selim/repo/eryaz/angular/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"/Users/selim/repo/eryaz/angular/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/selim/repo/eryaz/angular/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport { Injector, EventEmitter } from '@angular/core';\nimport { forEach as _forEach, includes as _includes, map as _map } from 'lodash-es';\nimport { AppComponentBase } from '@shared/app-component-base';\nimport { RoleDto, RoleEditDto } from '@shared/service-proxies/service-proxies';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@shared/service-proxies/service-proxies\";\nimport * as i2 from \"ngx-bootstrap/modal\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"ngx-bootstrap/tabs\";\nimport * as i6 from \"../../../shared/components/validation/abp-validation.summary.component\";\nimport * as i7 from \"../../../shared/components/modal/abp-modal-header.component\";\nimport * as i8 from \"../../../shared/components/modal/abp-modal-footer.component\";\nimport * as i9 from \"@shared/pipes/localize.pipe\";\n\nfunction EditRoleDialogComponent_ng_container_36_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r9 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 19)(2, \"div\", 20)(3, \"input\", 21);\n    i0.ɵɵlistener(\"change\", function EditRoleDialogComponent_ng_container_36_Template_input_change_3_listener($event) {\n      var restoredCtx = i0.ɵɵrestoreView(_r9);\n      var permission_r6 = restoredCtx.$implicit;\n      var ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.onPermissionChange(permission_r6, $event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"label\", 22);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    var permission_r6 = ctx.$implicit;\n    var i_r7 = ctx.index;\n    var ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"id\", \"permission_\" + i_r7)(\"checked\", ctx_r5.isPermissionChecked(permission_r6.name))(\"disabled\", ctx_r5.role.isStatic);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"for\", \"permission_\" + i_r7);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", permission_r6.displayName, \" \");\n  }\n}\n\nexport var EditRoleDialogComponent = /*#__PURE__*/function (_AppComponentBase) {\n  _inherits(EditRoleDialogComponent, _AppComponentBase);\n\n  var _super = _createSuper(EditRoleDialogComponent);\n\n  function EditRoleDialogComponent(injector, _roleService, bsModalRef) {\n    var _this;\n\n    _classCallCheck(this, EditRoleDialogComponent);\n\n    _this = _super.call(this, injector);\n    _this._roleService = _roleService;\n    _this.bsModalRef = bsModalRef;\n    _this.saving = false;\n    _this.role = new RoleEditDto();\n    _this.checkedPermissionsMap = {};\n    _this.onSave = new EventEmitter();\n    return _this;\n  }\n\n  _createClass(EditRoleDialogComponent, [{\n    key: \"ngOnInit\",\n    value: function ngOnInit() {\n      var _this2 = this;\n\n      this._roleService.getRoleForEdit(this.id).subscribe(function (result) {\n        _this2.role = result.role;\n        _this2.permissions = result.permissions;\n        _this2.grantedPermissionNames = result.grantedPermissionNames;\n\n        _this2.setInitialPermissionsStatus();\n      });\n    }\n  }, {\n    key: \"setInitialPermissionsStatus\",\n    value: function setInitialPermissionsStatus() {\n      var _this3 = this;\n\n      _map(this.permissions, function (item) {\n        _this3.checkedPermissionsMap[item.name] = _this3.isPermissionChecked(item.name);\n      });\n    }\n  }, {\n    key: \"isPermissionChecked\",\n    value: function isPermissionChecked(permissionName) {\n      return _includes(this.grantedPermissionNames, permissionName);\n    }\n  }, {\n    key: \"onPermissionChange\",\n    value: function onPermissionChange(permission, $event) {\n      this.checkedPermissionsMap[permission.name] = $event.target.checked;\n    }\n  }, {\n    key: \"getCheckedPermissions\",\n    value: function getCheckedPermissions() {\n      var permissions = [];\n\n      _forEach(this.checkedPermissionsMap, function (value, key) {\n        if (value) {\n          permissions.push(key);\n        }\n      });\n\n      return permissions;\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      var _this4 = this;\n\n      this.saving = true;\n      var role = new RoleDto();\n      role.init(this.role);\n      role.grantedPermissions = this.getCheckedPermissions();\n\n      this._roleService.update(role).subscribe(function () {\n        _this4.notify.info(_this4.l('SavedSuccessfully'));\n\n        _this4.bsModalRef.hide();\n\n        _this4.onSave.emit();\n      }, function () {\n        _this4.saving = false;\n      });\n    }\n  }]);\n\n  return EditRoleDialogComponent;\n}(AppComponentBase);\n\nEditRoleDialogComponent.ɵfac = function EditRoleDialogComponent_Factory(t) {\n  return new (t || EditRoleDialogComponent)(i0.ɵɵdirectiveInject(i0.Injector), i0.ɵɵdirectiveInject(i1.RoleServiceProxy), i0.ɵɵdirectiveInject(i2.BsModalRef));\n};\n\nEditRoleDialogComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: EditRoleDialogComponent,\n  selectors: [[\"ng-component\"]],\n  outputs: {\n    onSave: \"onSave\"\n  },\n  features: [i0.ɵɵInheritDefinitionFeature],\n  decls: 38,\n  vars: 28,\n  consts: [[\"autocomplete\", \"off\", 1, \"form-horizontal\", 3, \"ngSubmit\"], [\"editRoleForm\", \"ngForm\"], [3, \"title\", \"onCloseClick\"], [1, \"modal-body\"], [1, \"pt-3\", \"px-2\", 3, \"heading\"], [1, \"form-group\", \"row\", \"required\"], [\"for\", \"name\", 1, \"col-md-3\", \"col-form-label\"], [1, \"col-md-9\"], [\"type\", \"text\", \"name\", \"name\", \"id\", \"name\", \"required\", \"\", \"minlength\", \"2\", \"maxlength\", \"32\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"nameModel\", \"ngModel\", \"nameEl\", \"\"], [3, \"control\", \"controlEl\"], [\"for\", \"displayName\", 1, \"col-md-3\", \"col-form-label\"], [\"type\", \"text\", \"name\", \"displayName\", \"id\", \"displayName\", \"required\", \"\", \"minlength\", \"2\", \"maxlength\", \"32\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"displayNameModel\", \"ngModel\", \"displayNameEl\", \"\"], [1, \"form-group\", \"row\", \"mb-0\"], [\"for\", \"description\", 1, \"col-md-3\", \"col-form-label\"], [\"type\", \"text\", \"name\", \"description\", \"id\", \"description\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [4, \"ngFor\", \"ngForOf\"], [3, \"cancelDisabled\", \"saveDisabled\", \"onCancelClick\"], [1, \"col-md-6\"], [1, \"custom-control\", \"custom-checkbox\"], [\"type\", \"checkbox\", 1, \"custom-control-input\", 3, \"id\", \"checked\", \"disabled\", \"change\"], [1, \"custom-control-label\", 3, \"for\"]],\n  template: function EditRoleDialogComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"form\", 0, 1);\n      i0.ɵɵlistener(\"ngSubmit\", function EditRoleDialogComponent_Template_form_ngSubmit_0_listener() {\n        return ctx.save();\n      });\n      i0.ɵɵelementStart(2, \"abp-modal-header\", 2);\n      i0.ɵɵlistener(\"onCloseClick\", function EditRoleDialogComponent_Template_abp_modal_header_onCloseClick_2_listener() {\n        return ctx.bsModalRef.hide();\n      });\n      i0.ɵɵpipe(3, \"localize\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"div\", 3)(5, \"tabset\")(6, \"tab\", 4);\n      i0.ɵɵpipe(7, \"localize\");\n      i0.ɵɵelementStart(8, \"div\", 5)(9, \"label\", 6);\n      i0.ɵɵtext(10);\n      i0.ɵɵpipe(11, \"localize\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"div\", 7)(13, \"input\", 8, 9);\n      i0.ɵɵlistener(\"ngModelChange\", function EditRoleDialogComponent_Template_input_ngModelChange_13_listener($event) {\n        return ctx.role.name = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(16, \"abp-validation-summary\", 10);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(17, \"div\", 5)(18, \"label\", 11);\n      i0.ɵɵtext(19);\n      i0.ɵɵpipe(20, \"localize\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(21, \"div\", 7)(22, \"input\", 12, 13);\n      i0.ɵɵlistener(\"ngModelChange\", function EditRoleDialogComponent_Template_input_ngModelChange_22_listener($event) {\n        return ctx.role.displayName = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(25, \"abp-validation-summary\", 10);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(26, \"div\", 14)(27, \"label\", 15);\n      i0.ɵɵtext(28);\n      i0.ɵɵpipe(29, \"localize\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(30, \"div\", 7)(31, \"textarea\", 16);\n      i0.ɵɵlistener(\"ngModelChange\", function EditRoleDialogComponent_Template_textarea_ngModelChange_31_listener($event) {\n        return ctx.role.description = $event;\n      });\n      i0.ɵɵtext(32, \"            \");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(33, \"tab\", 4);\n      i0.ɵɵpipe(34, \"localize\");\n      i0.ɵɵelementStart(35, \"div\", 14);\n      i0.ɵɵtemplate(36, EditRoleDialogComponent_ng_container_36_Template, 6, 5, \"ng-container\", 17);\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(37, \"abp-modal-footer\", 18);\n      i0.ɵɵlistener(\"onCancelClick\", function EditRoleDialogComponent_Template_abp_modal_footer_onCancelClick_37_listener() {\n        return ctx.bsModalRef.hide();\n      });\n      i0.ɵɵelementEnd()();\n    }\n\n    if (rf & 2) {\n      var _r0 = i0.ɵɵreference(1);\n\n      var _r1 = i0.ɵɵreference(14);\n\n      var _r2 = i0.ɵɵreference(15);\n\n      var _r3 = i0.ɵɵreference(23);\n\n      var _r4 = i0.ɵɵreference(24);\n\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"title\", i0.ɵɵpipeBind1(3, 16, \"EditRole\"));\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"heading\", i0.ɵɵpipeBind1(7, 18, \"Details\"));\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(11, 20, \"Name\"), \" \");\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngModel\", ctx.role.name);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"control\", _r1)(\"controlEl\", _r2);\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(20, 22, \"DisplayName\"), \" \");\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngModel\", ctx.role.displayName);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"control\", _r3)(\"controlEl\", _r4);\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(29, 24, \"RoleDescription\"), \" \");\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngModel\", ctx.role.description);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"heading\", i0.ɵɵpipeBind1(34, 26, \"Permissions\"));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngForOf\", ctx.permissions);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"cancelDisabled\", ctx.saving)(\"saveDisabled\", !_r0.form.valid || ctx.saving);\n    }\n  },\n  dependencies: [i3.NgForOf, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.MinLengthValidator, i4.MaxLengthValidator, i4.NgModel, i4.NgForm, i5.TabDirective, i5.TabsetComponent, i6.AbpValidationSummaryComponent, i7.AbpModalHeaderComponent, i8.AbpModalFooterComponent, i9.LocalizePipe],\n  encapsulation: 2\n});","map":{"version":3,"mappings":"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","names":["Injector","EventEmitter","forEach","_forEach","includes","_includes","map","_map","AppComponentBase","RoleDto","RoleEditDto","i0","ctx_r5","EditRoleDialogComponent","injector","_roleService","bsModalRef","getRoleForEdit","id","subscribe","result","role","permissions","grantedPermissionNames","setInitialPermissionsStatus","item","checkedPermissionsMap","name","isPermissionChecked","permissionName","permission","$event","target","checked","value","key","push","saving","init","grantedPermissions","getCheckedPermissions","update","notify","info","l","hide","onSave","emit","selectors","outputs","features","decls","vars","consts","template","ctx","_r2","_r4"],"sourceRoot":"","sources":["/Users/selim/repo/eryaz/angular/src/app/roles/edit-role/edit-role-dialog.component.ts","/Users/selim/repo/eryaz/angular/src/app/roles/edit-role/edit-role-dialog.component.html"],"sourcesContent":["import {\n  Component,\n  Injector,\n  OnInit,\n  EventEmitter,\n  Output,\n} from '@angular/core';\nimport { BsModalRef } from 'ngx-bootstrap/modal';\nimport { forEach as _forEach, includes as _includes, map as _map } from 'lodash-es';\nimport { AppComponentBase } from '@shared/app-component-base';\nimport {\n  RoleServiceProxy,\n  GetRoleForEditOutput,\n  RoleDto,\n  PermissionDto,\n  RoleEditDto,\n  FlatPermissionDto\n} from '@shared/service-proxies/service-proxies';\n\n@Component({\n  templateUrl: 'edit-role-dialog.component.html'\n})\nexport class EditRoleDialogComponent extends AppComponentBase\n  implements OnInit {\n  saving = false;\n  id: number;\n  role = new RoleEditDto();\n  permissions: FlatPermissionDto[];\n  grantedPermissionNames: string[];\n  checkedPermissionsMap: { [key: string]: boolean } = {};\n\n  @Output() onSave = new EventEmitter<any>();\n\n  constructor(\n    injector: Injector,\n    private _roleService: RoleServiceProxy,\n    public bsModalRef: BsModalRef\n  ) {\n    super(injector);\n  }\n\n  ngOnInit(): void {\n    this._roleService\n      .getRoleForEdit(this.id)\n      .subscribe((result: GetRoleForEditOutput) => {\n        this.role = result.role;\n        this.permissions = result.permissions;\n        this.grantedPermissionNames = result.grantedPermissionNames;\n        this.setInitialPermissionsStatus();\n      });\n  }\n\n  setInitialPermissionsStatus(): void {\n    _map(this.permissions, (item) => {\n      this.checkedPermissionsMap[item.name] = this.isPermissionChecked(\n        item.name\n      );\n    });\n  }\n\n  isPermissionChecked(permissionName: string): boolean {\n    return _includes(this.grantedPermissionNames, permissionName);\n  }\n\n  onPermissionChange(permission: PermissionDto, $event) {\n    this.checkedPermissionsMap[permission.name] = $event.target.checked;\n  }\n\n  getCheckedPermissions(): string[] {\n    const permissions: string[] = [];\n    _forEach(this.checkedPermissionsMap, function (value, key) {\n      if (value) {\n        permissions.push(key);\n      }\n    });\n    return permissions;\n  }\n\n  save(): void {\n    this.saving = true;\n\n    const role = new RoleDto();\n    role.init(this.role);\n    role.grantedPermissions = this.getCheckedPermissions();\n\n    this._roleService.update(role).subscribe(\n      () => {\n        this.notify.info(this.l('SavedSuccessfully'));\n        this.bsModalRef.hide();\n        this.onSave.emit();\n      },\n      () => {\n        this.saving = false;\n      }\n    );\n  }\n}\n","<form\n  class=\"form-horizontal\"\n  autocomplete=\"off\"\n  #editRoleForm=\"ngForm\"\n  (ngSubmit)=\"save()\"\n>\n  <abp-modal-header\n    [title]=\"'EditRole' | localize\"\n    (onCloseClick)=\"bsModalRef.hide()\"\n  ></abp-modal-header>\n  <div class=\"modal-body\">\n    <tabset>\n      <tab [heading]=\"'Details' | localize\" class=\"pt-3 px-2\">\n        <div class=\"form-group row required\">\n          <label class=\"col-md-3 col-form-label\" for=\"name\">\n            {{ \"Name\" | localize }}\n          </label>\n          <div class=\"col-md-9\">\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              name=\"name\"\n              id=\"name\"\n              required\n              minlength=\"2\"\n              maxlength=\"32\"\n              [(ngModel)]=\"role.name\"\n              #nameModel=\"ngModel\"\n              #nameEl\n            />\n            <abp-validation-summary\n              [control]=\"nameModel\"\n              [controlEl]=\"nameEl\"\n            ></abp-validation-summary>\n          </div>\n        </div>\n        <div class=\"form-group row required\">\n          <label class=\"col-md-3 col-form-label\" for=\"displayName\">\n            {{ \"DisplayName\" | localize }}\n          </label>\n          <div class=\"col-md-9\">\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              name=\"displayName\"\n              id=\"displayName\"\n              required\n              minlength=\"2\"\n              maxlength=\"32\"\n              [(ngModel)]=\"role.displayName\"\n              #displayNameModel=\"ngModel\"\n              #displayNameEl\n            />\n            <abp-validation-summary\n              [control]=\"displayNameModel\"\n              [controlEl]=\"displayNameEl\"\n            ></abp-validation-summary>\n          </div>\n        </div>\n        <div class=\"form-group row mb-0\">\n          <label class=\"col-md-3 col-form-label\" for=\"description\">\n            {{ \"RoleDescription\" | localize }}\n          </label>\n          <div class=\"col-md-9\">\n            <textarea\n              type=\"text\"\n              class=\"form-control\"\n              name=\"description\"\n              id=\"description\"\n              [(ngModel)]=\"role.description\"\n            >\n            </textarea>\n          </div>\n        </div>\n      </tab>\n      <tab [heading]=\"'Permissions' | localize\" class=\"pt-3 px-2\">\n        <div class=\"form-group row mb-0\">\n          <ng-container *ngFor=\"let permission of permissions; let i = index\">\n            <div class=\"col-md-6\">\n              <div class=\"custom-control custom-checkbox\">\n                <input\n                  type=\"checkbox\"\n                  class=\"custom-control-input\"\n                  [id]=\"'permission_' + i\"\n                  [checked]=\"isPermissionChecked(permission.name)\"\n                  [disabled]=\"role.isStatic\"\n                  (change)=\"onPermissionChange(permission, $event)\"\n                />\n                <label class=\"custom-control-label\" [for]=\"'permission_' + i\">\n                  {{ permission.displayName }}\n                </label>\n              </div>\n            </div>\n          </ng-container>\n        </div>\n      </tab>\n    </tabset>\n  </div>\n  <abp-modal-footer\n    [cancelDisabled]=\"saving\"\n    [saveDisabled]=\"!editRoleForm.form.valid || saving\"\n    (onCancelClick)=\"bsModalRef.hide()\"\n  ></abp-modal-footer>\n</form>\n"]},"metadata":{},"sourceType":"module"}