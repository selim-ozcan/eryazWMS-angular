{"ast":null,"code":"import _classCallCheck from \"/Users/selim/repo/eryaz/angular/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/selim/repo/eryaz/angular/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport { Router, ActivatedRouteSnapshot, RouterStateSnapshot } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"abp-ng2-module\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../session/app-session.service\";\nexport var AppRouteGuard = /*#__PURE__*/function () {\n  function AppRouteGuard(_permissionChecker, _router, _sessionService) {\n    _classCallCheck(this, AppRouteGuard);\n\n    this._permissionChecker = _permissionChecker;\n    this._router = _router;\n    this._sessionService = _sessionService;\n  }\n\n  _createClass(AppRouteGuard, [{\n    key: \"canActivate\",\n    value: function canActivate(route, state) {\n      if (!this._sessionService.user) {\n        this._router.navigate(['/account/login']);\n\n        return false;\n      }\n\n      if (!route.data || !route.data['permission']) {\n        return true;\n      }\n\n      if (this._permissionChecker.isGranted(route.data['permission'])) {\n        return true;\n      }\n\n      this._router.navigate([this.selectBestRoute()]);\n\n      return false;\n    }\n  }, {\n    key: \"canActivateChild\",\n    value: function canActivateChild(route, state) {\n      return this.canActivate(route, state);\n    }\n  }, {\n    key: \"selectBestRoute\",\n    value: function selectBestRoute() {\n      if (!this._sessionService.user) {\n        return '/account/login';\n      }\n\n      if (this._permissionChecker.isGranted('Pages.Users')) {\n        return '/app/admin/users';\n      }\n\n      return '/app/home';\n    }\n  }]);\n\n  return AppRouteGuard;\n}();\n\nAppRouteGuard.ɵfac = function AppRouteGuard_Factory(t) {\n  return new (t || AppRouteGuard)(i0.ɵɵinject(i1.PermissionCheckerService), i0.ɵɵinject(i2.Router), i0.ɵɵinject(i3.AppSessionService));\n};\n\nAppRouteGuard.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: AppRouteGuard,\n  factory: AppRouteGuard.ɵfac\n});","map":{"version":3,"mappings":";;AAIA,SACiBA,MADjB,EAEIC,sBAFJ,EAGIC,mBAHJ,QAKO,iBALP;;;;;AAQA,WAAaC,aAAb;EAEI,uBACYC,kBADZ,EAEYC,OAFZ,EAGYC,eAHZ,EAG8C;IAAA;;IAFlC;IACA;IACA;EACP;;EANT;IAAA;IAAA,OAQI,qBAAYC,KAAZ,EAA2CC,KAA3C,EAAqE;MACjE,IAAI,CAAC,KAAKF,eAAL,CAAqBG,IAA1B,EAAgC;QAC5B,KAAKJ,OAAL,CAAaK,QAAb,CAAsB,CAAC,gBAAD,CAAtB;;QACA,OAAO,KAAP;MACH;;MAED,IAAI,CAACH,KAAK,CAACI,IAAP,IAAe,CAACJ,KAAK,CAACI,IAAN,CAAW,YAAX,CAApB,EAA8C;QAC1C,OAAO,IAAP;MACH;;MAED,IAAI,KAAKP,kBAAL,CAAwBQ,SAAxB,CAAkCL,KAAK,CAACI,IAAN,CAAW,YAAX,CAAlC,CAAJ,EAAiE;QAC7D,OAAO,IAAP;MACH;;MAED,KAAKN,OAAL,CAAaK,QAAb,CAAsB,CAAC,KAAKG,eAAL,EAAD,CAAtB;;MACA,OAAO,KAAP;IACH;EAxBL;IAAA;IAAA,OA0BI,0BAAiBN,KAAjB,EAAgDC,KAAhD,EAA0E;MACtE,OAAO,KAAKM,WAAL,CAAiBP,KAAjB,EAAwBC,KAAxB,CAAP;IACH;EA5BL;IAAA;IAAA,OA8BI,2BAAe;MACX,IAAI,CAAC,KAAKF,eAAL,CAAqBG,IAA1B,EAAgC;QAC5B,OAAO,gBAAP;MACH;;MAED,IAAI,KAAKL,kBAAL,CAAwBQ,SAAxB,CAAkC,aAAlC,CAAJ,EAAsD;QAClD,OAAO,kBAAP;MACH;;MAED,OAAO,WAAP;IACH;EAxCL;;EAAA;AAAA;;;mBAAaT,eAAaY;AAAA;;;SAAbZ;EAAaa,SAAbb,aAAa","names":["Router","ActivatedRouteSnapshot","RouterStateSnapshot","AppRouteGuard","_permissionChecker","_router","_sessionService","route","state","user","navigate","data","isGranted","selectBestRoute","canActivate","i0","factory"],"sourceRoot":"","sources":["/Users/selim/repo/eryaz/angular/src/shared/auth/auth-route-guard.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { PermissionCheckerService } from 'abp-ng2-module';\nimport { AppSessionService } from '../session/app-session.service';\n\nimport {\n    CanActivate, Router,\n    ActivatedRouteSnapshot,\n    RouterStateSnapshot,\n    CanActivateChild\n} from '@angular/router';\n\n@Injectable()\nexport class AppRouteGuard implements CanActivate, CanActivateChild {\n\n    constructor(\n        private _permissionChecker: PermissionCheckerService,\n        private _router: Router,\n        private _sessionService: AppSessionService,\n    ) { }\n\n    canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): boolean {\n        if (!this._sessionService.user) {\n            this._router.navigate(['/account/login']);\n            return false;\n        }\n\n        if (!route.data || !route.data['permission']) {\n            return true;\n        }\n\n        if (this._permissionChecker.isGranted(route.data['permission'])) {\n            return true;\n        }\n\n        this._router.navigate([this.selectBestRoute()]);\n        return false;\n    }\n\n    canActivateChild(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): boolean {\n        return this.canActivate(route, state);\n    }\n\n    selectBestRoute(): string {\n        if (!this._sessionService.user) {\n            return '/account/login';\n        }\n\n        if (this._permissionChecker.isGranted('Pages.Users')) {\n            return '/app/admin/users';\n        }\n\n        return '/app/home';\n    }\n}\n"]},"metadata":{},"sourceType":"module"}